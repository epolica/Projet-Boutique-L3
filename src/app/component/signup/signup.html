<app-navbar />
<section class="auth-page">
  <div class="auth-card">
    <div class="header">
      <p class="eyebrow">Bienvenue</p>
      <h2>Creer un compte</h2>
      <p class="subtitle">Rejoins la boutique, garde tes favoris et suis tes commandes.</p>
    </div>

    <form [formGroup]="form" (ngSubmit)="submit()">
      <div class="form-group">
        <label>Nom complet</label>
        <input type="text" formControlName="name" placeholder="Votre nom" class="form-control">
      </div>

      <div class="form-group">
        <label>Email</label>
        <input type="email" formControlName="email" placeholder="email@example.com" class="form-control">
      </div>

      <div formGroupName="passwords" class="row">
        <div class="form-group col">
          <label>Mot de passe</label>
          <input type="password" formControlName="password" class="form-control" placeholder="••••••••">
        </div>
        <div class="form-group col">
          <label>Confirmation</label>
          <input type="password" formControlName="confirm" class="form-control" placeholder="••••••••">
        </div>
      </div>

      @if (pw?.hasError('mismatch')) {
        <small class="err">Les mots de passe ne correspondent pas.</small>
      }

      <button class="btn-primary w-100" type="submit" [disabled]="form.invalid">
        {{ loading ? 'Creation...' : "S'inscrire" }}
      </button>

      <p class="hint">Deja un compte ? <a routerLink="/login">Se connecter</a></p>
    </form>

    <div class="divider">Mot de passe oublie ?</div>

    <form [formGroup]="resetForm" (ngSubmit)="sendResetLink()" class="reset-form">
      <div class="form-group">
        <label>Email de recuperation</label>
        <input type="email" formControlName="email" placeholder="email@example.com" class="form-control">
        @if (resetEmail?.invalid && resetEmail?.touched) {
          <small class="err">Adresse email invalide</small>
        }
      </div>

      <button class="btn-ghost w-100" type="submit" [disabled]="resetForm.invalid || resetLoading">
        {{ resetLoading ? 'Envoi...' : 'Recevoir un lien de reinitialisation' }}
      </button>

      @if (resetMessage) {
        <p class="status ok">{{ resetMessage }}</p>
      }
      @if (resetError) {
        <p class="status err">{{ resetError }}</p>
      }
      <p class="hint small">
        Tu as deja un token ? <a routerLink="/reset-password">Reinitialise ici</a>
      </p>
    </form>
  </div>

  <aside class="auth-aside">
    <h3>Pourquoi nous rejoindre ?</h3>
    <p>Acces rapide, suivi des commandes, offres exclusives et panier synchronise.</p>
    <a routerLink="/login" class="btn-ghost">Je me connecte</a>
  </aside>
</section>
